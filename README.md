# Accelerated Dictionary Generation with Machine Learning for Magnetic Resonance Fingerprinting

 

Discover more information and view illustrations in the Documentation PowerPoint.

## 0_RR_interval_sim
This module generates RR intervals for simulating patient heartbeats.
- **Script**: `RR_Intervals_Var_PhysioNet.m`
  - **Configuration**: Specify the number of "patients" (equivalent to 14 heartbeats) to generate.
  - `msize` tetermines how many RR-Intervals should be generated
**Filter Criteria**:
- Healthy Subjects from Physionet.org
- 1000 RR Interval Rhythms extracted from 24-hour measurements
- Sample size: 10 Persons aged 20-55

**Output**:
- `RR_Matrix_Full.txt`: A text file containing all RR intervals.

![image](https://github.com/user-attachments/assets/ea686945-4e6f-4d23-86fa-51f07e4cafcb)

![image](https://github.com/user-attachments/assets/35b46754-2e13-4c48-af0b-7d9a334f362a)


## 1_Data_Generator
Generates training data by simulating a dictionary (EPG) for each RR interval.
- **Important Inputs**:
  - `Dictlist = 'T1T2_lowfield_invivo'`: Defines the combinations of T1, T2, etc., to be generated. See `simulation_function` folder under `loadDictionarylist_v4`.
  - `RR_matrix = importdata('RR_Matrix_Full.txt')`: Imports the RR Interval Matrix generated by `0_RR_interval_sim`.
- **Outputs**:
  - `T1_T2_Combinations.csv`: A file listing all T1 and T2 combinations used.
  - `RR_1.h5`, `RR_2.h5`, ..., `RR_n.h5`: Each dictionary for each RR interval is saved separately in an H5 file.



![image](https://github.com/user-attachments/assets/7bdcfb21-099f-4955-b16b-255424d6c9d4)


## 2_Train_Model
Trains a GRU model with an attention layer.
- **Inputs**:
  - `my_batch_size = 8`
  - `my_learning_rate = 0.001`
  - `Input_n = 16`
  - `Output_n = 750`
  - `cpu = 16`
  - `first_layer = 256`
  - `second_layer = 128`
  - `saveEpochs = 2`: Model is saved every 2 epochs.

**Note**: A smaller batch size, though resulting in better memory performance and potentially improving model accuracy, may reduce generalization capabilities. A batch size of 16 has also shown good results.

![image](https://github.com/user-attachments/assets/94bc3894-3700-4c3e-b931-b2968707982b)


## 3_Dictionary_Generator
Generates the dictionary by predicting it through the trained GRU model.
- **Inputs**:
  - `model = load_model("GRU_Full_01-28_LR_1E-03_BS_8_att_pp")`: Model used for prediction.
  - **RR Intervals and Ranges**:
    - `RR_Intervals`: Specified list of RR intervals.
    - `t1_ranges` and `t2_ranges`: Specified ranges for T1 and T2 values.
![image](https://github.com/user-attachments/assets/bafe159c-add6-450f-8e45-7953a1ba0e29)


# MRF-Dictionary-Generation
 
